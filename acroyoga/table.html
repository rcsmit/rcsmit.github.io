<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acroyoga Poses - Dynamic - v1</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .controls {
            max-width: 1200px;
            margin: 0 auto 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .search-box {
            flex: 1;
            min-width: 250px;
        }
        .search-box input {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        .search-box input:focus {
            outline: none;
            border-color: #2c3e50;
        }
        .filter-box {
            flex: 0 0 auto;
        }
        .filter-box label {
            margin-right: 10px;
            font-weight: bold;
            color: #2c3e50;
        }
        .filter-box select {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        .filter-box select:focus {
            outline: none;
            border-color: #2c3e50;
        }
        .results-count {
            flex: 0 0 auto;
            color: #666;
            font-size: 14px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        td {
            padding: 15px;
            text-align: center;
            vertical-align: top;
            border: 1px solid #ddd;
            width: 25%; /* Default 4 columns */
        }
        .label {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        iframe {
            border: none;
            border-radius: 4px;
        }

        /* Responsive columns */
        @media screen and (max-width: 1400px) {
            td {
                width: 33.33%; /* 3 columns */
            }
        }
        @media screen and (max-width: 1024px) {
            td {
                width: 50%; /* 2 columns */
            }
        }
        @media screen and (max-width: 640px) {
            td {
                width: 100%; /* 1 column */
            }
            iframe {
                width: 100%;
                max-width: 280px;
            }
        }
    </style>
</head>
<body>
    <h1>Acroyoga Poses Video Gallery</h1>
    
    <div class="controls">
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Search poses by name...">
        </div>
        <div class="filter-box">
            <label for="categoryFilter">Category:</label>
            <select id="categoryFilter">
                <option value="all">All Categories</option>
            </select>
        </div>
        <div class="results-count" id="resultsCount"></div>
    </div>
    
    <table id="posesTable"></table>

    <script>
        const data = {
            nodes: [
                { "id": "101" , "video":"dQw4w9WgXcQ", "label": "LEGENDA", "category":"no_box", "x": 1510, "y": 780 },
                { "id": "x_1" , "video":"l2IFcLpEpMY", "label": "front plank", "category":"pose", "x": 36, "y": 550 },
                { "id": "x_2" , "video":"l2IFcLpEpMY", "label": "front bird", "category":"pose", "x": 350, "y": 550 },
                { "id": "x_5" , "video":"2ONOnNAHT4A", "label": "folded leaf", "category":"pose", "x": 650, "y": 550 },
                { "id": "x_7" , "video":"BqUpzbc2uxM", "label": "straddle throne", "category":"pose", "x": 530, "y": 640 },
                { "id": "x_8" , "video":"dollsSxNWzg", "label": "chair", "category":"pose", "x": 530, "y": 750 },
                { "id": "x_9" , "video":"gixLd-6i9ko", "label": "foot to shin", "category":"pose", "x": 350, "y": 750 },
                { "id": "x_17" , "video":"_f7S0rtE0zI", "label": "couch", "category":"pose", "x": 720, "y": 640 },
                { "id": "x_21" , "video":"qTaM5V8o03M", "label": "reverse#straddle throne", "category":"pose", "x": 890, "y": 715 },
                { "id": "x_24" , "video":"nn5NCMujhV8", "label": "shin to foot", "category":"pose", "x": 36, "y": 848 },
                { "id": "x_26" , "video":"dQw4w9WgXcQ", "label": "flamingo", "category":"pose", "x": 36, "y": 758 },
                { "id": "x_29" , "video":"dxY9NK9yMYw", "label": "maria pose", "category":"pose", "x": 36, "y": 948 },
                { "id": "x_31" , "video":"4WMAZ67brUc", "label": "high flying whale", "category":"pose", "x": 530, "y": 850 },
                { "id": "x_33" , "video":"3Y_Ojvvgn3g", "label": "candle stick/#shoulder stand", "category":"pose", "x": 345, "y": 370 },
                { "id": "x_35" , "video":"wPz777LU01Y", "label": "free shoulder stand", "category":"pose", "x": 553, "y": 370 },
                { "id": "x_40" , "video":"d_lto3XbRgY", "label": "side star", "category":"pose", "x": 36, "y": 655 },
                { "id": "x_42" , "video":"PZ0oq-SHHnE", "label": "straddle bat", "category":"pose", "x": 1201, "y": 550 },
                { "id": "x_44" , "video":"_erVFJvQi8g", "label": "inside side star", "category":"pose", "x": 1201, "y": 410 },
                { "id": "x_46" , "video":"_erVFJvQi8g", "label": "inside side star", "category":"pose", "x": 1348, "y": 490 },
                { "id": "x_48" , "video":"nZk8rZ1cG8c", "label": "reverse bird", "category":"pose", "x": 1488, "y": 490 },
                { "id": "x_51" , "video":"WCcijC9PyCI", "label": "floating paschi", "category":"pose", "x": 1348, "y": 680 },
                { "id": "x_55" , "video":"PLyfrobh9f4", "label": "backbird", "category":"pose", "x": 1302, "y": 880 },
                { "id": "x_57" , "video":"Vv7wtCZcoaI", "label": "back leaf", "category":"pose", "x": 1202, "y": 970 },
                { "id": "x_59" , "video":"NnzCvcTfTJg", "label": "boat", "category":"pose", "x": 1342, "y": 970 },
                { "id": "x_63" , "video":"AaiXojb-LSA", "label": "star", "category":"pose", "x": 900, "y": 290 },
                { "id": "y_5" , "video":"dQw4w9WgXcQ", "label": "handstand in/out#(head side)_", "category":"entry_exit", "x": 1152, "y": 870 },
                { "id": "y_8" , "video":"W9oA6iLEeMs", "label": "four step", "category":"washing_machine", "x": 900, "y": 190 },
                { "id": "y_15" , "video":"dQw4w9WgXcQ", "label": "cartwheel in_", "category":"entry_exit", "x": 1201, "y": 290 },
                { "id": "y_17" , "video":"row_0nk_X4w", "label": "low barrel roll", "category":"transition", "x": 809, "y": 480 },
                { "id": "y_23" , "video":"dQw4w9WgXcQ", "label": "helicopter_", "category":"transition", "x": 720, "y": 370 },
                { "id": "y_27" , "video":"Xk8uuOm2uwU", "label": "catherinas#wheel", "category":"washing_machine", "x": 413, "y": 460 },
                { "id": "y_30" , "video":"u5eglkm1jv0", "label": "monkey frog", "category":"washing_machine", "x": 980, "y": 850 },
                { "id": "y_33" , "video":"T-jwcZI1WbI", "label": "corkscrew", "category":"transition", "x": 719, "y": 290 },
                { "id": "y_39" , "video":"dQw4w9WgXcQ", "label": "entry / exit", "category":"entry_exit", "x": 1510, "y": 820 },
                { "id": "y_40" , "video":"dQw4w9WgXcQ", "label": "pose", "category":"pose", "x": 1510, "y": 913 },
                { "id": "y_41" , "video":"dQw4w9WgXcQ", "label": "washing machine", "category":"washing_machine", "x": 1510, "y": 1080 },
                { "id": "3" , "video":"phsbUzEv_us", "label": "bed / couch", "category":"pose", "x": 396, "y": 950 },
                { "id": "8" , "video":"StZQFy3EykI", "label": "reverse#foot to hand", "category":"pose", "x": 265, "y": 950 },
                { "id": "10" , "video":"8wimvXZDvSA", "label": "reverse star", "category":"pose", "x": 659, "y": 950 },
                { "id": "11" , "video":"qLP9E_mpmFs", "label": "bird on hand", "category":"pose", "x": 940, "y": 950 },
                { "id": "17" , "video":"NIlGbKM06R8", "label": "reverse shoulderstand", "category":"pose", "x": 839, "y": 850 },
                { "id": "19" , "video":"ZoUtn_Z_ULI", "label": "thinker#secretary", "category":"pose", "x": 700, "y": 850 },
                { "id": "28" , "video":"OWtMYyY6KwA", "label": "around the world", "category":"transition", "x": 721, "y": 720 },
                { "id": "36" , "video":"docOE4QT0ec", "label": "biceps stand", "category":"pose", "x": 552, "y": 260 },
                { "id": "37" , "video":"dQw4w9WgXcQ", "label": "crocodile_", "category":"pose", "x": 552, "y": 170 },
                { "id": "38" , "video":"c-eHZmKy3ro", "label": "foot to hand", "category":"pose", "x": 720, "y": 170 },
                { "id": "45" , "video":"xdsnsqIZaCQ", "label": "bow", "category":"pose", "x": 290, "y": 640 },
                { "id": "49" , "video":"c-eHZmKy3ro", "label": "foot to hand", "category":"pose", "x": 1020, "y": 680 },
                { "id": "50" , "video":"nZk8rZ1cG8c", "label": "reverse bird", "category":"pose", "x": 1160, "y": 680 },
                { "id": "60" , "video":"dQw4w9WgXcQ", "label": "handstand in/out#(legs side)_", "category":"entry_exit", "x": 340, "y": 840 },
                { "id": "61" , "video":"NZR0OfbYKA", "label": "trapdoor", "category":"transition", "x": 1252, "y": 770 },
                { "id": "64" , "video":"dQw4w9WgXcQ", "label": "reverse#foot to shin_", "category":"pose", "x": 527, "y": 1090 },
                { "id": "66" , "video":"4UAfHgjbvxY", "label": "tuck sit", "category":"pose", "x": 264, "y": 1090 },
                { "id": "67" , "video":"dQw4w9WgXcQ", "label": "revese shin#to foot_", "category":"pose", "x": 396, "y": 1090 },
                { "id": "68" , "video":"8wimvXZDvSA", "label": "reverse star", "category":"pose", "x": 345, "y": 260 },
                { "id": "69" , "video":"kC4daUVQEoY", "label": "reverse#back plank", "category":"pose", "x": 530, "y": 950 },
                { "id": "72" , "video":"dQw4w9WgXcQ", "label": "(reverse)#foot to foot_", "category":"pose", "x": 700, "y": 1090 },
                { "id": "73" , "video":"diA5w1-L2L8", "label": "(baby) (reverse)#hand to hand ", "category":"pose", "x": 900, "y": 1090 },
                { "id": "82" , "video":"93v90kJcGlE", "label": "rev. feet to hand ", "category":"pose", "x": 200, "y": 260 },
                { "id": "85" , "video":"dQw4w9WgXcQ", "label": "Rene Smit @rcsmit#CC BY-NC 4.0 ", "category":"no_box", "x": 41, "y": 1090 },
                { "id": "87" , "video":"iHtotyrqt1s", "label": "koala queen", "category":"washing_machine", "x": 1060, "y": 190 },
                { "id": "88" , "video":"6vi2AYwAmqw", "label": "spider roll", "category":"washing_machine", "x": 1040, "y": 290 },
                { "id": "93" , "video":"dQw4w9WgXcQ", "label": "START", "category":"start", "x": 36, "y": 430 },
                { "id": "96" , "video":"dQw4w9WgXcQ", "label": "transition", "category":"transition", "x": 1510, "y": 997 },
                { "id": "99" , "video":"a8fCNt2Qi2E", "label": "crunch roll", "category":"washing_machine", "x": 1111, "y": 770 },
                { "id": "106" , "video":"eFRgbbsVxNk", "label": "rotisserie", "category":"washing_machine", "x": 1356, "y": 380 },
                { "id": "110" , "video":"qLP9E_mpmFs", "label": "bird on hands", "category":"pose", "x": 210, "y": 460 },
                { "id": "z_2" , "video":"p1oeyEVgRfM", "label": "ballerina", "category":"washing_machine", "x": 180, "y": 611 },
                { "id": "z_5" , "video":"jbtQWzQ3v7g", "label": "big le moi", "category":"washing_machine", "x": 174, "y": 691 },
                { "id": "117" , "video":"yyOFOv-whjs", "label": "mermaid", "category":"transition", "x": 791, "y": 950 },
                { "id": "119" , "video":"yO7kJogH8cA", "label": "high barrel roll", "category":"washing_machine", "x": 1201, "y": 190 },
                { "id": "z_8" , "video":"dQw4w9WgXcQ", "label": "jump in_", "category":"entry_exit", "x": 345, "y": 160 },
                { "id": "121" , "video":"row_0nk_X4w", "label": "barrel roll", "category":"washing_machine", "x": 1348, "y": 570 },
                { "id": "123" , "video":"kyks9JyPPv8", "label": "buddha roll", "category":"transition", "x": 1040, "y": 610 },
                { "id": "6545" , "video":"iy_eJDDMXYI", "label": "table top", "category":"pose", "x": 952, "y": 561 },
                { "id": "z_1" , "video":"YKj4G0J-6Xs", "label": "prasarita twist", "category":"transition", "x": 810, "y": 549 }
            ]
        };

  

        // Function to create iframe HTML
        function createIframe(videoId) {
            return `<iframe width="280" height="157" src="https://www.youtube.com/embed/${videoId}?si=EJNPiLa76TiQBHXK" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`;
        }

        // Function to get unique categories
        function getCategories() {
            const categories = new Set();
            data.nodes.forEach(node => {
                if (node.video !== 'dQw4w9WgXcQ') {
                    categories.add(node.category);
                }
            });
            return Array.from(categories).sort();
        }

        // Function to populate category dropdown
        function populateCategoryFilter() {
            const categoryFilter = document.getElementById('categoryFilter');
            const categories = getCategories();
            
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category.replace(/_/g, ' ');
                categoryFilter.appendChild(option);
            });
        }

        // Function to filter nodes based on search and category
        function filterNodes() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const selectedCategory = document.getElementById('categoryFilter').value;
            
            let filtered = data.nodes.filter(node => node.video !== 'dQw4w9WgXcQ');
            
            // Filter by search term
            if (searchTerm) {
                filtered = filtered.filter(node => 
                    node.label.toLowerCase().includes(searchTerm)
                );
            }
            
            // Filter by category
            if (selectedCategory !== 'all') {
                filtered = filtered.filter(node => node.category === selectedCategory);
            }
            
            return filtered;
        }

        // Function to update results count
        function updateResultsCount(count, total) {
            const resultsCount = document.getElementById('resultsCount');
            resultsCount.textContent = `Showing ${count} of ${total} poses`;
        }

        // Function to get number of columns based on screen width
        function getColumnsPerRow() {
            const width = window.innerWidth;
            if (width <= 640) return 1;
            if (width <= 1024) return 2;
            if (width <= 1400) return 3;
            return 4;
        }

        // Store current state to avoid unnecessary rebuilds
        let lastFilteredNodesJSON = '';
        let lastColumnsPerRow = getColumnsPerRow();

        // Function to generate the table
        function generateTable() {
            const table = document.getElementById('posesTable');
            
            // Get filtered nodes
            const filteredNodes = filterNodes();
            const totalNodes = data.nodes.filter(node => node.video !== 'dQw4w9WgXcQ').length;
            const columnsPerRow = getColumnsPerRow();
            
            // Check if we actually need to rebuild
            const currentFilteredNodesJSON = JSON.stringify(filteredNodes.map(n => n.id));
            if (lastFilteredNodesJSON === currentFilteredNodesJSON && lastColumnsPerRow === columnsPerRow) {
                return; // No changes, skip rebuild
            }
            
            lastFilteredNodesJSON = currentFilteredNodesJSON;
            lastColumnsPerRow = columnsPerRow;
            
            // Update results count
            updateResultsCount(filteredNodes.length, totalNodes);
            
            // Clear existing content
            table.innerHTML = '';
            
            // Calculate number of rows needed
            const totalRows = Math.ceil(filteredNodes.length / columnsPerRow);
            
            // Generate rows
            for (let i = 0; i < totalRows; i++) {
                const row = document.createElement('tr');
                
                // Generate columns for this row
                for (let j = 0; j < columnsPerRow; j++) {
                    const index = i * columnsPerRow + j;
                    
                    if (index < filteredNodes.length) {
                        const node = filteredNodes[index];
                        const cell = document.createElement('td');
                        
                        cell.innerHTML = `
                            <div class="label">${node.label}</div>
                            ${createIframe(node.video)}
                        `;
                        
                        row.appendChild(cell);
                    } else {
                        // Add empty cell if we've run out of data
                        const emptyCell = document.createElement('td');
                        row.appendChild(emptyCell);
                    }
                }
                
                table.appendChild(row);
            }
            
            // Show message if no results
            if (filteredNodes.length === 0) {
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.setAttribute('colspan', columnsPerRow);
                cell.style.textAlign = 'center';
                cell.style.padding = '40px';
                cell.style.color = '#666';
                cell.innerHTML = '<h3>No poses found</h3><p>Try adjusting your search or filter.</p>';
                row.appendChild(cell);
                table.appendChild(row);
            }
        }

        // Debounce function for search
        let searchTimeout;
        function debounceSearch() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(generateTable, 300);
        }

        // Initialize the page
        window.addEventListener('DOMContentLoaded', function() {
            populateCategoryFilter();
            generateTable();
            
            // Add event listeners for search and filter
            document.getElementById('searchInput').addEventListener('input', debounceSearch);
            document.getElementById('categoryFilter').addEventListener('change', generateTable);
        });
        
        // Regenerate table when window is resized (with debounce and state checking)
        let resizeTimer;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(generateTable, 250);
        });
    </script>
</body>
</html>